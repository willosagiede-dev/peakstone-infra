### Minimal pgCat config (0.2.5) tailored for this stack
### Pool name MUST match the DB you connect to (POSTGRES_DB)

[general]
host = "0.0.0.0"
port = 6432
admin_username = "pgcat"
admin_password = "change-this-strong"

# Optional hardening
connect_timeout = 5000
idle_timeout    = 30000
healthcheck_timeout = 1000
healthcheck_delay   = 30000
ban_time = 60   # seconds; how long to ban a bad server
worker_threads = 5  # number of worker threads
autoreload = 15000

tcp_keepalives_idle = 5
tcp_keepalives_count = 5
tcp_keepalives_interval = 5

# Pool name matches DB clients connect to
[pools.postgres]
pool_mode = "session"       # Hasura needs session; PostgREST can use transaction if you run a second pgcat
default_role = "primary"    # route to primary by default

[pools.postgres.users.0]
username = "postgres"       # replace with POSTGRES_SUPERUSER if different
password = "<POSTGRES_SUPERPASS>"  # replace with your superuser password
pool_size = 20
min_pool_size = 1

[pools.postgres.shards.0]
database = "postgres"       # replace with POSTGRES_DB
servers = [
  ["postgres", 5432, "primary"]  # Docker service name + port
]
